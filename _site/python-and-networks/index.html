<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>Python and Networks &#8211; Dan Carmody</title> <meta name="description" content=""> <meta name="keywords" content="python, networks, visualization"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/moon_man.jpeg"> <meta name="twitter:title" content="Python and Networks"> <meta name="twitter:description" content="Exploring network characteristics with Python and NetworkX"> <meta name="twitter:site" content="@carmodydr"> <meta name="twitter:creator" content="@carmodydr"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Python and Networks"> <meta property="og:description" content="Exploring network characteristics with Python and NetworkX"> <meta property="og:url" content="http://localhost:4000/python-and-networks/"> <meta property="og:site_name" content="Dan Carmody"> <meta property="og:image" content="http://localhost:4000/assets/img/moon_man.jpeg"> <link rel="canonical" href="http://localhost:4000/python-and-networks/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Dan Carmody Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- JS --> <script src="/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/whitney.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <!-- Google tracking ID --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-50791294-1', 'danielcarmody.net'); ga('send', 'pageview'); </script> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/moon_man.jpeg" alt="Dan Carmody photo" class="author-photo"> <h4>Dan Carmody</h4> <p></p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/carmodydr" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://linkedin.com/in/dan-carmody" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://instagram.com/dancarmody" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-instagram"></i> Instagram</a> </li> <li> <a href="http://github.com/carmodydr" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> <li> <a href="http://www.flickr.com/carmodydr" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-flickr"></i> Flickr</a> </li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://localhost:4000/posts/">All Posts</a></li> <li><a href="http://localhost:4000/tags/">All Tags</a></li> </ul> </li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Python and Networks</h1> <h4>28 Jul 2016</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~4.085 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://localhost:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="networks-graphs-and-trees">Networks: graphs and trees</h1> <p>I’ve put together a Jupyter notebook to help me sort out and understand various concepts concerning graphs and nd their implementation in Python. Sometime in the future I’ll do the same for trees.</p> <div><pre><code class="python">import pandas as pd
import networkx as nx
import json
import seaborn as sns</code></pre></div> <h1 id="graphs">Graphs</h1> <p>To help make some of these ideas more concrete, I’m playing around with the character graph data from Les Misérables. This has been wonderfully visualized by Mike Bostock <a href="https://bl.ocks.org/mbostock/4062045">using D3</a>. That link also provides the data in JSON format. There is also a GML version available <a href="https://networkdata.ics.uci.edu/data.php?id=109">here</a>. Ideally I should just be able to load this into networkx, but having run into trouble with that I’m instead using this as an opportunity to gain some experience with the pandas merge function.</p> <p>First, I open the JSON file and store the edge and node information in separate dataframes.</p><pre class="brush: python">
mis_file = open('miserables.json')
les_mis_json = json.load(mis_file)
mis_links = pd.DataFrame(les_mis_json['links'])
mis_nodes = pd.DataFrame(les_mis_json['nodes'])
</pre><p>Using pandas.merge, associate the source and target nodes with the actual character names.</p> <p><code>python edge_list_df = pd.merge(mis_links,mis_nodes,left_on='source',right_index=True) edge_list_df = pd.merge(edge_list_df,mis_nodes,left_on='target',right_index=True,suffixes=('_source','_target')) </code></p> <p>Now I drop the information I don’t want.</p> <p><code>python edge_list_df.drop(['group_source','group_target','source','target'],axis=1,inplace=True) </code></p> <p><code>python le_graph = nx.from_pandas_dataframe(edge_list_df,'name_source','name_target') </code></p> <p><code>python print "Number of nodes (characters) in this graph is", le_graph.order() # number of nodes print "Number of edges in this graph is", len(le_graph.edges()) # number of edges print "Graph diamer is", nx.diameter(le_graph) # maximum eccentricity </code></p><pre><code>Number of nodes (characters) in this graph is 77
Number of edges in this graph is 254
Graph diamer is 5
</code></pre><p><code>python nx.draw(le_graph) </code></p> <p><img src="/assets/img/posts/output_13_0.png" alt="png" /></p> <p>The default graph drawing in networkx is not bad (in this specific case), but it’s not particularly helpful, especially without labels. Although these can be included, the result is even less illuminating.</p> <p><code>python nx.draw_networkx(le_graph) </code></p> <p><img src="/assets/img/posts/output_15_0.png" alt="png" /></p> <p><code>python nx.write_graphml(le_graph,'miserables.graphml') </code></p><pre><code>graphml2gv miserables.graphml &gt; miserables.gv
dot -Tpng miserables.gv &gt; mis_dot.png
</code></pre><p>Where <code>dot</code> is the graphviz command to produce a particular graph layout. Also available are <code>neato</code>, <code>fdp</code>, and a few others. It all depends on the characteristics of the graph and what looks the best.</p> <p>After this processing, we can visualize the graph using GraphViz:</p> <p><img src="/assets/img/posts/mis_fdp.png" alt="mis_fdp" /></p> <p>This is much clearer!</p> <p><code>python nx.eigenvector_centrality </code></p> <h3 id="measurements-of-centrality">Measurements of centrality</h3> <p>Centrality, as a general idea, is meant to quantify the importance of a vertex within a network. There are different ways that this can be done, and one’s choice for a centrality metric often depends on what the graph is actually representing and the nature of the edge relationships.</p> <p>That said, some common measurements of centrality are: - degree centrality &gt; Degree is the most straightforward measure of importance. It is evaluated as the degree <code>d</code> of a node divided by the maximum possible number of connections (<code>n-1</code> in a graph with <code>n</code> nodes). - closeness centrality &gt; Closeness probably best aligns with our intuitive idea of what it means to be central. It looks at the shortest paths from the node of interest to all other nodes, sums these paths, and then takes the reciprocal. This is evaluated as $C(v) = \frac{n - 1}{\sum d(v, u)}$, where $d(v,u)$ represents the shortest path between nodes $v$ and $u$. - betweenness centrality &gt; Betweenness quantifies the importance of a node’s role in linking together other vertices. This is especially important if edges represent the flow of something. It is evaluated as $C_B(v) =\sum \frac{\sigma(s, t|v)}{\sigma(s, t)}$, where $\sigma(s, t|v)$ is the number of shortest paths that pass through $v$ and $\sigma(s, t)$ is the total number of shortest paths. - eigenvector centrality &gt; Computed using the adjacency matric, eigenvector centrality quantifies the idea that a node is important if it is linked to by other important nodes. It is a measure of influence, and Google’s PageRank is apparently a variation of this method.</p> <p>```python degrees = le_graph.degree()</p> <p>bw_cen = nx.betweenness_centrality(le_graph) # check the documentation, what is this actually calc?</p> <p>eig_cen = nx.centrality.eigenvector_centrality(le_graph)</p> <p>cls_cen = nx.centrality.closeness_centrality(le_graph)</p> <p>deg_cen = nx.centrality.degree_centrality(le_graph) ```</p> <p><code>python bw = pd.Series(bw_cen) eig = pd.Series(eig_cen) cls = pd.Series(cls_cen) deg = pd.Series(deg_cen) </code></p> <p><code>python bw_df = pd.DataFrame(bw.sort_values(),columns=['Betweenness']) cls_df = pd.DataFrame(cls.sort_values(),columns=['Closeness']) deg_df = pd.DataFrame(deg.sort_values(),columns=['Degree']) eig_df = pd.DataFrame(eig.sort_values(),columns=['Eigenvector']) </code></p> <p><code>python fig = figure() sns.regplot(bw.sort_index(),deg.sort_index(),fit_reg=False,scatter=True) ax = fig.axes ax[0].set_xlabel('Betweenness') ax[0].set_ylabel('Degree') </code></p><pre><code>&lt;matplotlib.text.Text at 0x7f1b66b07b50&gt;
</code></pre><p><img src="/assets/img/posts/output_24_1.png" alt="png" /></p> <p>The outlier in the top right corner is Valjean, by far the most central character in the story. It’s interesting to note, however, there are some measures of centrality that do not place Valjean at the top. Eigenvector centrality actually places him second to Gavroche, the intrepid little street urchin.</p> <p>As a bit of an aside, networkx has built-in methods for generating trees from more general graphs using breadth-first search or depth-first search. We can see what these look like when using Valjean as the root node.</p> <p><code>python bfs = nx.breadth_first_search.bfs_tree(le_graph,'Valjean') dfs = nx.depth_first_search.dfs_tree(le_graph,'Valjean') </code></p> <p><code>python nx.write_graphml(bfs,'mis_bfs.graphml') nx.write_graphml(dfs,'mis_dfs.graphml') </code></p> <p>The BFS tree is <img src="/assets/img/posts/mis_bfs_fdp.png" alt="mis_bfs" /></p> <p>The DFS tree is <img src="/assets/img/posts/mis_dfs_dot.png" alt="mis_bfs" /></p> <p>There is plenty more to discuss concerning graphs, such as path search algorithms like Dijkstra and Bellman-Ford, and plenty more besides to say about trees. I suppose that’ll just have to wait.</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#python" title="Pages tagged python" class="tag"><span class="term">python</span></a><a href="http://localhost:4000/tags/#networks" title="Pages tagged networks" class="tag"><span class="term">networks</span></a><a href="http://localhost:4000/tags/#visualization" title="Pages tagged visualization" class="tag"><span class="term">visualization</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/python-and-networks/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Like</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/python-and-networks/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/python-and-networks/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'dan'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
